(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{"9cEW":function(e,t,i){"use strict";i.r(t),i.d(t,"AkiModule",(function(){return D}));var r=i("ofXK"),s=i("AcyG"),a=i("tyNb"),c=i("mrSG"),n=i("g1w/"),o=i("O4L6"),l=i("aMzL"),d=i("W7l/");let u=(()=>{class e{}return e.type="[AKI] load",e})(),b=(()=>{class e{}return e.type="[AKI] reset",e})(),p=(()=>{class e{}return e.type="[AKI] predict",e})();var g,h=i("fXoL"),f=i("uaho");const m=16,O={features:d,x:Object(o.c)(n.a,m),y:Object(o.b)(n.a),predictions:Object(o.b)(n.a),weights:Object(o.c)(n.a,m),isLoading:!1};let j=(()=>{let e=g=class{constructor(e){this.api=e}static features(e){return e.features}static x(e){return e.x}static formattedX(e,t,i,r){return Array(n.a).fill(0).map((e,s)=>t.map(e=>s>=r?"-":Object(l.a)(e.identifier,e.group,i[s][e.id])))}static emptyDayStart(e,t){for(let i=0;i<t.length;i++)if(t[i].every(e=>0===e))return 0===i?Number.POSITIVE_INFINITY:i;return Number.POSITIVE_INFINITY}static y(e){return e.y}static predictions(e){return e.predictions}static slicedPredictions(e,t,i){return t.slice(0,i)}static weights(e){return e.weights}static computedWeights(e,t,i,r){return t?Array(n.a).fill(0).map((e,t)=>i.map(e=>Object(o.a)(e,t,r)).map(e=>({"background-color":`rgba(${n.d}, ${n.c}, ${n.b}, ${e/.5})`}))):Array(n.a).fill(Array(i.length).fill(null))}static showPredictions(e){return e.predictions.some(e=>0!=e)}static showWeights(e){return e.weights.some(e=>e.some(e=>0!=e))}static isLoading(e){return e.isLoading}loadSample({patchState:e}){return Object(c.a)(this,void 0,void 0,(function*(){e({isLoading:!0});const t=yield this.api.loadSample("aki").toPromise(),i=n.a-8;for(let e=0;e<i;e++)t.x.push(Array(m).fill(0));e({x:t.x,y:t.y,predictions:Object(o.b)(n.a),weights:Object(o.c)(n.a,m),isLoading:!1})}))}reset({patchState:e}){e({x:Object(o.c)(n.a,m),y:Object(o.b)(n.a),predictions:Object(o.b)(n.a),weights:Object(o.c)(n.a,m)})}predict({patchState:e,getState:t}){return Object(c.a)(this,void 0,void 0,(function*(){e({isLoading:!0});const{x:i}=t(),r=i.slice(0,8),s=yield this.api.predict("aki",r).toPromise(),a=n.a-8;for(let e=0;e<a;e++)s.predictions.push(0),s.weights.push(Array(m).fill(0));e({predictions:s.predictions,weights:s.weights,isLoading:!1})}))}};return e.\u0275fac=function(t){return new(t||e)(h.Ub(f.a))},e.\u0275prov=h.Jb({token:e,factory:e.\u0275fac}),Object(c.b)([Object(s.a)(u)],e.prototype,"loadSample",null),Object(c.b)([Object(s.a)(b)],e.prototype,"reset",null),Object(c.b)([Object(s.a)(p)],e.prototype,"predict",null),Object(c.b)([Object(s.d)()],e,"features",null),Object(c.b)([Object(s.d)()],e,"x",null),Object(c.b)([Object(s.d)([g.features,g.x,g.emptyDayStart])],e,"formattedX",null),Object(c.b)([Object(s.d)([g.x])],e,"emptyDayStart",null),Object(c.b)([Object(s.d)()],e,"y",null),Object(c.b)([Object(s.d)()],e,"predictions",null),Object(c.b)([Object(s.d)([g.predictions,g.emptyDayStart])],e,"slicedPredictions",null),Object(c.b)([Object(s.d)()],e,"weights",null),Object(c.b)([Object(s.d)([g.showWeights,g.features,g.weights])],e,"computedWeights",null),Object(c.b)([Object(s.d)()],e,"showPredictions",null),Object(c.b)([Object(s.d)()],e,"showWeights",null),Object(c.b)([Object(s.d)()],e,"isLoading",null),e=g=Object(c.b)([Object(s.e)({name:"aki",defaults:O})],e),e})();var y=i("mPeW"),w=i("4vgS"),L=i("CQvJ");const I=[{path:"",component:(()=>{class e{constructor(e){this.store=e,this.features$=this.store.select(j.features),this.x$=this.store.select(j.x),this.formattedX$=this.store.select(j.formattedX),this.weights$=this.store.select(j.computedWeights),this.slicedPredictions$=this.store.select(j.slicedPredictions),this.showPredictions$=this.store.select(j.showPredictions),this.isLoading$=this.store.select(j.isLoading)}onLoadSample(){this.store.dispatch(new u)}onReset(){this.store.dispatch(new b)}onPredict(){this.store.dispatch(new p)}}return e.\u0275fac=function(t){return new(t||e)(h.Nb(s.f))},e.\u0275cmp=h.Hb({type:e,selectors:[["app-aki"]],decls:13,vars:21,consts:[[1,"container"],[1,"feature-table"],["weightsBaseColor","#9C27B0",3,"features","x","formattedX","weights"],[1,"results"],[3,"isLoading","loadSample","reset","predict"],["label","\u60a3\u8005\u5f53\u65e5\u51fa\u73b0\u6025\u6027\u80be\u635f\u4f24\u7684\u6982\u7387\u5982\u4e0b",3,"showResults","probabilities"]],template:function(e,t){1&e&&(h.Qb(0,"div",0),h.Qb(1,"div",1),h.Ob(2,"app-feature-table",2),h.cc(3,"async"),h.cc(4,"async"),h.cc(5,"async"),h.cc(6,"async"),h.Pb(),h.Qb(7,"div",3),h.Qb(8,"app-data-operations",4),h.Xb("loadSample",(function(){return t.onLoadSample()}))("reset",(function(){return t.onReset()}))("predict",(function(){return t.onPredict()})),h.cc(9,"async"),h.Pb(),h.Ob(10,"app-model-results",5),h.cc(11,"async"),h.cc(12,"async"),h.Pb(),h.Pb()),2&e&&(h.Bb(2),h.gc("features",h.dc(3,7,t.features$))("x",h.dc(4,9,t.x$))("formattedX",h.dc(5,11,t.formattedX$))("weights",h.dc(6,13,t.weights$)),h.Bb(6),h.gc("isLoading",h.dc(9,15,t.isLoading$)),h.Bb(2),h.gc("showResults",h.dc(11,17,t.showPredictions$))("probabilities",h.dc(12,19,t.slicedPredictions$)))},directives:[y.a,w.a,L.a],pipes:[r.b],styles:[".container[_ngcontent-%COMP%]{display:flex;height:100%;flex-direction:row}.results[_ngcontent-%COMP%]{flex:1;padding:15px 20px}"],changeDetection:0}),e})()}];let P=(()=>{class e{}return e.\u0275mod=h.Lb({type:e}),e.\u0275inj=h.Kb({factory:function(t){return new(t||e)},imports:[[a.c.forChild(I)],a.c]}),e})();var x=i("PCNd");let D=(()=>{class e{}return e.\u0275mod=h.Lb({type:e}),e.\u0275inj=h.Kb({factory:function(t){return new(t||e)},imports:[[r.c,x.a,P,s.c.forFeature([j])]]}),e})()},"W7l/":function(e){e.exports=JSON.parse('[{"id":14,"identifier":"gender","group":"\u4e2a\u4eba\u4fe1\u606f","label":"\u6027\u522b","unit":null,"relatedIDs":[],"header":"\u4e2a\u4eba\u4fe1\u606f"},{"id":13,"identifier":"age","group":"\u4e2a\u4eba\u4fe1\u606f","label":"\u5e74\u9f84","unit":null,"relatedIDs":[]},{"id":12,"identifier":"weight","group":"\u4e2a\u4eba\u4fe1\u606f","label":"\u4f53\u91cd","unit":"kg","relatedIDs":[]},{"id":5,"identifier":"height","group":"\u4e2a\u4eba\u4fe1\u606f","label":"\u8eab\u9ad8","unit":"cm","relatedIDs":[]},{"id":15,"identifier":"black","group":"\u4e2a\u4eba\u4fe1\u606f","label":"\u662f\u5426\u9ed1\u4eba","unit":null,"relatedIDs":[]},{"id":0,"identifier":"bicarbonate","group":"\u5b9e\u9a8c\u7ed3\u679c","label":"\u78b3\u9178\u6c22\u76d0","unit":"mEq/L","relatedIDs":[],"header":"\u5b9e\u9a8c\u7ed3\u679c"},{"id":2,"identifier":"chloride","group":"\u5b9e\u9a8c\u7ed3\u679c","label":"\u6c2f\u5316\u7269","unit":"mEq/L","relatedIDs":[]},{"id":3,"identifier":"creatinine","group":"\u5b9e\u9a8c\u7ed3\u679c","label":"\u808c\u9178\u9150","unit":"mg/dL","relatedIDs":[]},{"id":4,"identifier":"glucose","group":"\u5b9e\u9a8c\u7ed3\u679c","label":"\u8461\u8404\u7cd6","unit":"mg/dL","relatedIDs":[]},{"id":7,"identifier":"magnesium","group":"\u5b9e\u9a8c\u7ed3\u679c","label":"\u9541","unit":"mg/dL","relatedIDs":[]},{"id":9,"identifier":"potassium","group":"\u5b9e\u9a8c\u7ed3\u679c","label":"\u94be","unit":"mEq/L","relatedIDs":[]},{"id":10,"identifier":"sodium","group":"\u5b9e\u9a8c\u7ed3\u679c","label":"\u94a0","unit":"mEq/L","relatedIDs":[]},{"id":1,"identifier":"BUN","group":"\u5b9e\u9a8c\u7ed3\u679c","label":"\u8840\u5c3f\u7d20\u6c2e","unit":"mg/dL","relatedIDs":[]},{"id":6,"identifier":"hemoglobin","group":"\u5b9e\u9a8c\u7ed3\u679c","label":"\u8840\u7ea2\u86cb\u767d","unit":"g/dL","relatedIDs":[]},{"id":8,"identifier":"platelets","group":"\u5b9e\u9a8c\u7ed3\u679c","label":"\u8840\u5c0f\u677f","unit":"K/uL","relatedIDs":[]},{"id":11,"identifier":"WBCs","group":"\u5b9e\u9a8c\u7ed3\u679c","label":"\u767d\u7ec6\u80de","unit":"K/uL","relatedIDs":[]}]')}}]);